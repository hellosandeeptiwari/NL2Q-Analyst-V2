[
  {
    "nl": "Show me patients with Tirosint target flag analysis",
    "sql": "-- Temporal analysis cannot be performed as there are no date columns specified for time-series analysis.\nSELECT TOP 100 [PrescriberName], [TirosintTargetFlag]\nFROM [dbo].[Reporting_BI_PrescriberOverview]\nWHERE [TirosintTargetFlag] = 'Y'",
    "job_id": "plan_1867790867698049573_test_mainstream",
    "user": "test_user",
    "timestamp": "2025-10-03T18:56:38.950821",
    "results": [
      {
        "PrescriberName": "JOAN ZIMMER",
        "TirosintTargetFlag": "Y"
      },
      {
        "PrescriberName": "NOLA GARDNER",
        "TirosintTargetFlag": "Y"
      },
      {
        "PrescriberName": "SAMANTHA MCGILL",
        "TirosintTargetFlag": "Y"
      },
      {
        "PrescriberName": "ANTONIO ZAMORANO",
        "TirosintTargetFlag": "Y"
      },
      {
        "PrescriberName": "JOHN MERENDINO",
        "TirosintTargetFlag": "Y"
      }
    ],
    "columns": [],
    "row_count": 100
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "-- This query identifies territories with good rep coverage and high activity levels, \n-- but low prescription rates for targeted products (Tirosint). \n-- It includes rep names for follow-up.\n\nSELECT \n    [TerritoryId],\n    [TerritoryName],\n    [PrescriberName],\n    COUNT([Calls4]) AS TotalCalls,\n    SUM([TRX(C4 Wk)]) AS TotalPrescriptions\nFROM \n    [dbo].[Reporting_BI_PrescriberOverview]\nWHERE \n    [TirosintTargetFlag] = 'Y' -- Focus on prescribers targeted for Tirosint\nGROUP BY \n    [TerritoryId], \n    [TerritoryName], \n    [PrescriberName]\nHAVING \n    SUM([TRX(C4 Wk)]) < 10 -- Prescriptions are low\n    AND COUNT([Calls4]) > 5 -- Good rep coverage with sufficient activity\nORDER BY \n    [TerritoryName]",
    "job_id": "plan_8134136196923851731_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T18:59:46.175660",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    ngd.[Territory] AS [Territory], \n    ngd.[PerformanceMetric] AS [Performance], \n    po.[RepName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS ngd\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS po ON ngd.[RepID] = po.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS pp ON po.[PrescriberID] = pp.[PrescriberID]\nORDER BY \n    ngd.[PerformanceMetric] ASC",
    "job_id": "plan_-3621226822751280460_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:22:17.801561",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[Territory] AS [Territory],\n    t1.[PerformanceMetric] AS [Performance],\n    t2.[RepName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_-3646935364578906149_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:24:37.221892",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[Territory], \n    t1.[PerformanceMetric], \n    t2.[RepName]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_-4180572162121490556_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:28:40.511724",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[Territory], \n    t1.[PerformanceMetric], \n    t2.[RepName]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_-8471846591446592480_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:36:09.062365",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[TerritoryName] AS [Territory], \n    t1.[PerformanceScore] AS [Performance], \n    t2.[RepresentativeName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceScore] ASC",
    "job_id": "plan_3121752901267538828_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:48:57.799230",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    ngd.[Territory] AS [Territory], \n    ngd.[PerformanceMetric] AS [Performance], \n    po.[RepName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS ngd\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS po ON ngd.[RepID] = po.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS pp ON po.[PrescriberID] = pp.[PrescriberID]\nORDER BY \n    ngd.[PerformanceMetric] ASC",
    "job_id": "plan_-7849190129152081031_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:56:04.983660",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with performance data",
    "sql": "SELECT TOP 100 \n    t1.[TerritoryID] AS [Territory],\n    t1.[PerformanceMetricID] AS [PerformanceMetric],\n    t2.[PrescriberName] AS [PrescriberName],\n    t3.[TirosintTargetFlag] AS [TirosintTargetFlag],\n    ISNULL(t1.[TRXCount], 0) AS [TransactionCount],\n    ISNULL(t1.[NRXCount], 0) AS [NewPrescriptionCount]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[PrescriberID] = t2.[PrescriberID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nWHERE \n    t3.[TirosintTargetFlag] = 'Y'",
    "job_id": "plan_4889562656652119161_default_session",
    "user": "test_user",
    "timestamp": "2025-10-03T20:57:51.087261",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[TerritoryName] AS [Territory],\n    t1.[PerformanceValue] AS [Performance],\n    t2.[RepresentativeName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepresentativeID] = t2.[RepresentativeID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceValue] ASC",
    "job_id": "plan_-5996604444966481547_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:02:10.732363",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[PerformanceMetric] AS [Territory],\n    t2.[RepName],\n    ISNULL(t1.[TRXCount], 0) AS [TransactionCount],\n    ISNULL(t1.[NRXCount], 0) AS [NewPrescriptionCount]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    [TransactionCount] ASC, [NewPrescriptionCount] ASC",
    "job_id": "plan_-5814046479134004366_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:03:28.849196",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[TerritoryName] AS [Territory], \n    t1.[PerformanceScore] AS [Performance], \n    t2.[RepresentativeName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceScore] ASC",
    "job_id": "plan_-1551312091441471429_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:05:36.262865",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[Territory] AS [Territory], \n    t1.[PerformanceMetric] AS [Performance], \n    t2.[RepName] AS [Representative]\nFROM \n    [dbo].[Reporting_BI_NGD] AS t1\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS t2 ON t1.[RepID] = t2.[RepID]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberID] = t3.[PrescriberID]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_3231391875531174740_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:09:39.976404",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[TerritoryName] AS [Territory], \n    t1.[PerformanceMetric] AS [Performance], \n    t2.[PrescriberName] AS [Representative]\nFROM \n    [Reporting_BI_NGD] AS t1\nJOIN \n    [Reporting_BI_PrescriberOverview] AS t2 ON t1.[TerritoryId] = t2.[TerritoryId]\nJOIN \n    [Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberId] = t3.[PrescriberId]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_25810667760397463_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:10:57.094302",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    t1.[TerritoryName] AS [Territory], \n    t1.[PerformanceMetric] AS [Performance], \n    t2.[PrescriberName] AS [Representative]\nFROM \n    [Reporting_BI_NGD] AS t1\nJOIN \n    [Reporting_BI_PrescriberOverview] AS t2 ON t1.[TerritoryId] = t2.[TerritoryId]\nJOIN \n    [Reporting_BI_PrescriberProfile] AS t3 ON t2.[PrescriberId] = t3.[PrescriberId]\nORDER BY \n    t1.[PerformanceMetric] ASC",
    "job_id": "plan_2209531536310880982_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:15:35.083531",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "Show me territories with the lowest performance, including rep names",
    "sql": "SELECT TOP 10 \n    ngd.[TerritoryName], \n    ngd.[PerformanceMetric], \n    po.[PrescriberName]\nFROM \n    [dbo].[Reporting_BI_NGD] AS ngd\nJOIN \n    [dbo].[Reporting_BI_PrescriberOverview] AS po ON ngd.[PrescriberId] = po.[PrescriberId]\nJOIN \n    [dbo].[Reporting_BI_PrescriberProfile] AS pp ON po.[PrescriberId] = pp.[PrescriberId]\nORDER BY \n    ngd.[PerformanceMetric] ASC",
    "job_id": "plan_2585551184396590734_test_session",
    "user": "test_user",
    "timestamp": "2025-10-03T21:17:11.730600",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "\"I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.\"\n",
    "sql": "SELECT TOP 100 \n    ngd.[TerritoryName], \n    ngd.[RegionName], \n    ngd.[RepName], \n    ISNULL(po.[TRX], 0) AS TotalPrescriptions, \n    ISNULL(po.[Calls], 0) AS TotalCalls, \n    ISNULL(po.[Samples], 0) AS TotalSamples, \n    ISNULL(pp.[NRX], 0) AS NewPrescriptions, \n    ISNULL(pp.[TRXShare], 0) AS PrescriptionShare\nFROM \n    dbo.Reporting_BI_NGD AS ngd\nJOIN \n    dbo.Reporting_BI_PrescriberOverview AS po ON ngd.[TerritoryId] = po.[TerritoryId]\nJOIN \n    dbo.Reporting_BI_PrescriberProfile AS pp ON ngd.[PrescriberId] = pp.[PrescriberId]\nWHERE \n    po.[TirosintTargetFlag] = 'Y' \n    AND ISNULL(po.[TRX], 0) < 10 \n    AND ISNULL(po.[Calls], 0) > 20\nORDER BY \n    TotalPrescriptions ASC",
    "job_id": "plan_6189537887595401760_conv_1",
    "user": "default_user",
    "timestamp": "2025-10-05T19:14:06.108360",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(ISNULL(po.[NRX(C QTD)], 0)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberOverview po ON ngd.[TerritoryId] = po.[TerritoryId]\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100 *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY TotalActivities DESC",
    "job_id": "plan_4212433409604881732_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:08:53.821193",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(ISNULL(po.[NRX(C QTD)], 0)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberOverview po ON ngd.[TerritoryId] = po.[TerritoryId]\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100 *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY TotalActivities DESC",
    "job_id": "plan_6843896766653837244_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:09:52.597820",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(ISNULL(po.[NRX(C QTD)], 0)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberOverview po ON ngd.[TerritoryId] = po.[TerritoryId]\n    WHERE po.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100 *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY TotalActivities DESC",
    "job_id": "plan_-3152889422989613557_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:10:53.828553",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS INT)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_-5917592900910802474_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:15:27.741483",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "-- Dynamic multi-table join template\nSELECT TOP 10 \n    t1.RegionId,\n    t1.RegionName,\n    t1.TerritoryId,\n    t1.TerritoryName,\n    t2.RegionId,\n    t2.RegionName\nFROM Reporting_BI_PrescriberOverview t1\nINNER JOIN Reporting_BI_PrescriberProfile t2 ON t1.RegionId = t2.RegionId;\n-- Join condition determined dynamically from schema",
    "job_id": "plan_-4937230710089724963_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:18:58.201113",
    "results": [
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006001",
        "TerritoryName": "Charlotte NC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006013",
        "TerritoryName": "Nashville TN"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006009",
        "TerritoryName": "Washington DC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006004",
        "TerritoryName": "Columbia SC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006005",
        "TerritoryName": "Richmond VA"
      }
    ],
    "columns": [],
    "row_count": 10
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS INT)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_3925513183099172263_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:24:06.562849",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS INT)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_7323615768911279362_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:25:29.056964",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(ngd.[TotalCalls]) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS INT)) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_891878520993418972_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:27:13.439567",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_9143927738827656972_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:28:22.309308",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_4001939151525237410_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:29:13.304211",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_5523313309395101844_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:32:18.653786",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_-6537633710821715039_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:33:29.478137",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_6252327420077355210_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:34:24.785007",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_-1374565061879663518_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:35:55.572782",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS DECIMAL(18,2))) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_-136980990732848965_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:37:17.569189",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_-3478416611168434007_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:38:31.327043",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_-4138211243556408544_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:40:07.895385",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_-6415234254591330930_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:55:22.514543",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "SELECT 'Error' as error",
    "job_id": "plan_-693785863216595239_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:56:10.319185",
    "results": [
      {
        "error": "Error"
      }
    ],
    "columns": [],
    "row_count": 1
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "SELECT 'Error' as error",
    "job_id": "plan_-3965966287566997045_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:56:57.522883",
    "results": [
      {
        "error": "Error"
      }
    ],
    "columns": [],
    "row_count": 1
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_6727182833753316778_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:57:50.056892",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "-- Dynamic multi-table join template\nSELECT TOP 10 \n    t1.RegionId,\n    t1.RegionName,\n    t1.TerritoryId,\n    t1.TerritoryName,\n    t2.RegionId,\n    t2.RegionName\nFROM Reporting_BI_PrescriberOverview t1\nINNER JOIN Reporting_BI_PrescriberProfile t2 ON t1.RegionId = t2.RegionId;\n-- Join condition determined dynamically from schema",
    "job_id": "plan_6540952564131368524_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T20:59:21.763435",
    "results": [
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006001",
        "TerritoryName": "Charlotte NC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006013",
        "TerritoryName": "Nashville TN"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006009",
        "TerritoryName": "Washington DC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006004",
        "TerritoryName": "Columbia SC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006005",
        "TerritoryName": "Richmond VA"
      }
    ],
    "columns": [],
    "row_count": 10
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_-6662828624588115024_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:00:12.115877",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(po.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberOverview po ON ngd.[TerritoryId] = po.[TerritoryId]\n    WHERE po.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100 *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY TotalActivities DESC",
    "job_id": "plan_4782468779584760988_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:01:12.288632",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "SELECT 'Error' as error",
    "job_id": "plan_7428136024853736598_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:03:22.311436",
    "results": [
      {
        "error": "Error"
      }
    ],
    "columns": [],
    "row_count": 1
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_-415968659317793878_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:04:47.342248",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(pp.[TRX]) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_4088134773844716808_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:06:01.809462",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(CAST(pp.[TRX] AS DECIMAL(18,2))) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_5622022743438811180_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:08:59.508971",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "-- Dynamic multi-table join template\nSELECT TOP 10 \n    t1.RegionId,\n    t1.RegionName,\n    t1.TerritoryId,\n    t1.TerritoryName,\n    t2.RegionId,\n    t2.RegionName\nFROM Reporting_BI_PrescriberOverview t1\nINNER JOIN Reporting_BI_PrescriberProfile t2 ON t1.RegionId = t2.RegionId;\n-- Join condition determined dynamically from schema",
    "job_id": "plan_7148540329019696115_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:12:28.498359",
    "results": [
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006001",
        "TerritoryName": "Charlotte NC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006013",
        "TerritoryName": "Nashville TN"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006009",
        "TerritoryName": "Washington DC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006004",
        "TerritoryName": "Columbia SC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006005",
        "TerritoryName": "Richmond VA"
      }
    ],
    "columns": [],
    "row_count": 10
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(TRY_CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(TRY_CAST(pp.[TRX] AS DECIMAL(18,2))) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT TOP 100\n    m.[TerritoryName],\n    m.RepCount,\n    m.TotalActivities,\n    m.TotalPrescriptions\nFROM metrics m\nWHERE m.RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND m.TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)\nORDER BY m.TotalActivities DESC",
    "job_id": "plan_3301978263863321119_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:13:09.932128",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(TRY_CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(TRY_CAST(pp.[TRX] AS DECIMAL(18,2))) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_8330988048008457403_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:14:37.616530",
    "results": [],
    "columns": [],
    "row_count": 0
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "-- Dynamic multi-table join template\nSELECT TOP 10 \n    t1.RegionId,\n    t1.RegionName,\n    t1.TerritoryId,\n    t1.TerritoryName,\n    t2.RegionId,\n    t2.RegionName\nFROM Reporting_BI_PrescriberOverview t1\nINNER JOIN Reporting_BI_PrescriberProfile t2 ON t1.RegionId = t2.RegionId;\n-- Join condition determined dynamically from schema",
    "job_id": "plan_-8345590944171825206_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:16:30.384508",
    "results": [
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006001",
        "TerritoryName": "Charlotte NC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006013",
        "TerritoryName": "Nashville TN"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006009",
        "TerritoryName": "Washington DC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006004",
        "TerritoryName": "Columbia SC"
      },
      {
        "RegionId": "100060",
        "RegionName": "Midatlantic",
        "TerritoryId": "10006005",
        "TerritoryName": "Richmond VA"
      }
    ],
    "columns": [],
    "row_count": 10
  },
  {
    "nl": "I need to understand why some territories are underperforming - show me territories where we have good rep coverage and are doing lots of activities, but prescribers still aren't writing many prescriptions for our targeted products. Include the rep names so I can follow up.",
    "sql": "WITH metrics AS (\n    SELECT\n        ngd.[TerritoryName],\n        COUNT(DISTINCT ngd.[RepName]) AS RepCount,\n        SUM(TRY_CAST(ngd.[TotalCalls] AS DECIMAL(18,2))) AS TotalActivities,\n        SUM(TRY_CAST(pp.[TRX] AS DECIMAL(18,2))) AS TotalPrescriptions\n    FROM dbo.Reporting_BI_NGD ngd\n    JOIN dbo.Reporting_BI_PrescriberProfile pp ON ngd.[PrescriberId] = pp.[PrescriberId]\n    WHERE pp.[TirosintTargetFlag] = 'Y'\n    GROUP BY ngd.[TerritoryName]\n)\nSELECT *\nFROM metrics\nWHERE RepCount > (SELECT AVG(RepCount) FROM metrics)\n  AND TotalPrescriptions < (SELECT AVG(TotalPrescriptions) FROM metrics)",
    "job_id": "plan_-3338479835289099268_test_session",
    "user": "test_user",
    "timestamp": "2025-10-05T21:17:10.646520",
    "results": [],
    "columns": [],
    "row_count": 0
  }
]